<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Lucas S, Samuel H, João V, Pedro H">
        <meta name="generator" content="Pycharm and VS Code">
        <meta name="description" content="Help da API">
        <meta name="keywords" content="Python, Flask, Pandas, Plotly, API, Ciência de Dados">
        <title>API de Dados de Ocorências Criminais (#equipe4)</title>
        <style>
            html {
                background-color:  #F5F5F5;
                color: #dbedf3;
                text-align: center;
            }

            body {
                width: 65%;
                margin: 0px auto;
            }

            .testes, p,h2,h3 {
                font-weight: normal;
                color: black;
                text-decoration: none;
                padding-left: 10px;
                text-align: justify;
            }

            .topicos{
                font-weight: bold;
            }

            p {
                font-size: 19px;
            }

            #img1 {
                width: 60%;
            }

            #img2 {
                width: 25%;
            }

            h2,h3{
                font-weight: bold;
                color: rgb(15, 0, 150);
            }

            h1{
                color: black;
            }

            .ips, a {
                text-align: center;
                padding-top: 7px;
                padding-bottom: 7px;
                color: darkslategray;
                font-weight: bold;
                text-decoration: underline;
            }

        </style>
    </head>
    <body>
        <h1>Documentação da API de Ocorências Criminais (#equipe4)</h1>
        <br>

        <p>
            A API (Application Programming Interface) desenvolvida busca gerenciar as bases de dados livres sobre Ocorrências Criminais (SINESP - Ministério da Justiça) disponíveis no link: http://dados.gov.br/dataset/sistema-nacional-de-estatisticas-de-seguranca-publica.<br>
            Todas suas requisições são interpretadas a partir do método GET, portanto tudo pode ser requisitado diretamente pela URL. As respostas para as requisições de consulta à API estão no formato JSON e possuem a seguinte estrutura:<br>
        </p>
        <img src="{{url_for('static', filename='Capturar.PNG')}}" id="img1">

        <p>
            A API também pode retornar uma página HTML para requisições de plotagem de mapas e gráficos.<br>
            A seguir serão explicadas todas as requisições que a API é capaz de responder. <br>
            Se a requisição estiver com algum erro em sua construção, ou o argumento key não estiver contido na requisição ou na lista de chaves autorizadas, a API retorna um JSON simples alertando sobre o problema.<br>
        </p>

        <h2>Estrutura</h2>
        <img src="{{url_for('static', filename='estrutura.PNG')}}" id="img2">
        
        
        <h2>Buscas</h2>
        
        <h3>Buscas por bases completas</h3>
            <p>Você pode buscar todo o conteúdo de uma base de dados</p>
            <p class="topicos">Busca por ocorrências de crimes</p>
            <p class="ips"><a href="/ocorrencias?key=5fdeb7c5" target="_blank" rel="noopener noreferrer">ocorrencias?key=5fdeb7c5</a></p>

            <p class="topicos">Busca por vítimas fatais</p>
            <p class="ips"><a href="/vitimas?key=5fdeb7c5" target="_blank" rel="noopener noreferrer">vitimas?key=5fdeb7c5</a></p>
            
            <p class="topicos">Busca por vítimas em cada município</p>
            <p class="ips"><a href="/vitimas_municipios?key=397a32e6" target="_blank" rel="noopener noreferrer">vitimas_municipios?key=397a32e6</a></p>

        

        <h3>Busca filtrada por cada campo disponível</h3>
        <p>A partir de cada uma das bases requisitadas, mostradas acima, é possível realizar buscas à dados segundo alguma filtragem que desejar.</p>
        <br>

        <p class="topicos">A. filtragem por Estado</p>
        <p>Para filtrar os dados das bases pelo estado, você pode requisitar:</p>
        <p class="ips"><a href="/ocorrencias?key=5fdeb7c5&uf=CE" target="_blank" rel="noopener noreferrer">ocorrencias?key=5fdeb7c5&uf=CE</a></p>
        <br>

        <p class="topicos">B. Filtragem por tipo de crime</p>
        <p>Para filtrar os dados das bases pelo tipo de crime, você pode requisitar:</p>
        <p class="ips"><a href="/vitimas?key=5fdeb7c5&uf=CE&ano=2018&crime=Le" target="_blank" rel="noopener noreferrer">vitimas?key=5fdeb7c5&uf=CE&ano=2018&crime=Le</a></p>
         <br>

         <p class="topicos">C. Filtragem por ano</p>
         <p>Para filtrar os dados das bases pelo ano, você pode requisitar:</p>
         <p class="ips"><a href="/ocorrencias?key=5fdeb7c5&ano=2018" target="_blank" rel="noopener noreferrer">ocorrencias?key=5fdeb7c5&ano=2018</a></p>
         <br>

         <p class="topicos">D. Filtragem por mês</p>
         <p>Para filtrar os dados das bases pelo mês, você pode requisitar:</p>
         <p class="ips"><a href="/ocorrencias?key=5fdeb7c5&uf=CE&mes=jan" target="_blank" rel="noopener noreferrer">ocorrencias?key=5fdeb7c5&uf=CE&mes=jan</a></p>
         <br>

         <p class="topicos">E. Filtragem por região</p>
         <p>Para filtrar os dados por região, você pode requisitar: </p>
         <p class="ips"><a href="/vitimas?key=5fdeb7c5&regiao=norte" target="_blank" rel="noopener noreferrer">vitimas?key=5fdeb7c5&ampregiao=norte</a></p>
         <br>
        
        <p class="topicos">F. Filtragem por cidade</p>
        <p>Para filtrar os dados exclusivamente da base vitimas_municipios pela cidade, você pode requisitar:</p>
        <p class="ips"><a href="/vitimas_municipios?key=397a32e6&cid=Marco" target="_blank" rel="noopener noreferrer">vitimas_municipios?key=397a32e6&cid=Marco</a></p>
        <p>Para agregar filtros em uma mesma requisição, basta você separá-los pelo caractere especial &, como no exemplo abaixo:</p>
        <p class="ips"><a href="/ocorrencias?key=5fdeb7c5&uf=CE&ano=2018" target="_blank" rel="noopener noreferrer">ocorrencias?key=5fdeb7c5&uf=CE&ano=2018</a></p>
        <br>


        <h3>Rankeamento</h3>

        <p>Em qualquer requisição pode ser agregado o campo ranking que realiza um ordenamento na base de dados e retorna a quantidade de registros passados no valor deste campo, por exemplo:</p>
        <p class="ips"><a href="/vitimas?key=5fdeb7c5&ano=2015&ranking=10" target="_blank" rel="noopener noreferrer">vitimas?key=5fdeb7c5&ano=2015&ranking=10</a></p>
        
        <p class="topicos">Ordenação do rankeamento</p>
        <p>É possível também, alterar o sentido de ordenação dos registros retornado pela API, o padrão é o valor DESC, que ordena os registros de forma decrescente, mas se preferir pode alterá-lo para ASC, e então receber os dados ordenados de forma crescente. Por exemplo:</p>
        <p class="ips"><a href="/vitimas?key=5fdeb7c5&ano=2015&ranking=10&order=ASC" target="_blank" rel="noopener noreferrer">vitimas?key=5fdeb7c5&ano=2015&ranking=10&order=ASC</a></p>


        <h3>Requisições pré-definidas</h3>
        <p>A fim de tornar a API mais prática, foram desenvolvidas algumas requisições para simplificar a URL e trazer respostas para possíveis perguntas sobre as bases de dados. Para ter acesso às requisições pré-definidas na API, basta acessar:</p>
        
        <p class="topicos">Média de ocorrências a cada ano:</p>
        <p class="ips"><a href="/info/media_ocorrencias_anual?key=397a32e6" target="_blank" rel="noopener noreferrer">media_ocorrencias_anual</a></p>


    
        <p class="topicos">Média de ocorrências a cada mês:</p>
        <p class="ips"><a href="/info/media_ocorrencias_mensal?key=397a32e6" target="_blank" rel="noopener noreferrer">media_ocorrencias_mensal</a></p>

        
        <p class="topicos">Média de município a cada ano:</p>
        <p class="ips"><a href="/info/media_municipios_anual?key=397a32e6" target="_blank" rel="noopener noreferrer">media_municipios_anual</a></p>
        
        
        <p class="topicos">Média de município a cada mês:</p>
        <p class="ips"><a href="/info/media_municipios_mensal?key=397a32e6" target="_blank" rel="noopener noreferrer">media_municipios_mensal</a></p>
        
        
        <h3 >Plotagens</h3>
        <p>Outra idéia de tornar a API mais interativa, foram desenvolvidas algumas funcionalidades para criação de gráficos dinâmicos. Os gráficos são retornados como uma página HTML que é interpretada pelo próprio navegador que o requisitou.
        
        <p class="topicos">Plotar no mapa do Brasil a média de ocorrências em todos os estados:</p>
        <p class="ips"><a href="/plot/mapa_media_ocorrencias?key=397a32e6" target="_blank" rel="noopener noreferrer">Mapa de media das ocorrências</a></p>

        <p class="topicos">Plotar a média de ocorrências de cada tipo de crime em cada estado brasileiro em um gráfico de barras:</p>
        <p class="ips"><a href="/plot/barras_media_ocorrencias?key=397a32e6" target="_blank" rel="noopener noreferrer">barras_media_ocorrencias</a></p>
        
        <p class="topicos">Plotar a soma de ocorrências de cada tipo de crime em cada estado brasileiro em um gráfico de linhas:</p>
        <p class="ips"><a href="/plot/linha_soma_ocorrencias?key=397a32e6" target="_blank" rel="noopener noreferrer">linha_soma_ocorrencias</a></p>

        <h2>Testes</h2>
        <div class="testes">
            <h3>Base de Vítimas</h3>
            <p><a href="/vitimas?key=5fdeb7c5&uf=CE" target="_blank" rel="noopener noreferrer">vitimas?key=5fdeb7c5&uf=CE</a></p>
            <p><a href="/vitimas?key=5fdeb7c5&uf=CE&ano=2018" target="_blank" rel="noopener noreferrer">vitimas?key=5fdeb7c5&uf=CE&ano=2018</a></p>
            <p><a href="/vitimas?key=5fdeb7c5&uf=CE&ano=2018&crime=Le" target="_blank" rel="noopener noreferrer">vitimas?key=5fdeb7c5&uf=CE&ano=2018&crime=Le</a></p>
            <p><a href="/vitimas?key=5fdeb7c5&uf=CE&ano=2018&crime=Le&mes=jan" target="_blank" rel="noopener noreferrer">vitimas?key=5fdeb7c5&uf=CE&ano=2018&crime=Le&mes=jan</a></p>
            <br>
        </div>

        <h3>Base de Ocorrências</h3>
        <div class="testes">
            <p><a href="/ocorrencias?key=5fdeb7c5&uf=CE" target="_blank" rel="noopener noreferrer">ocorrencias?key=5fdeb7c5&uf=CE</a></p>
            <p><a href="/ocorrencias?key=5fdeb7c5&uf=CE&ano=2018" target="_blank" rel="noopener noreferrer">ocorrencias?key=5fdeb7c5&uf=CE&ano=2018</a></p>
            <p><a href="/ocorrencias?key=5fdeb7c5&uf=CE&ano=2018&crime=Le" target="_blank" rel="noopener noreferrer">ocorrencias?key=5fdeb7c5&uf=CE&ano=2018&crime=Le</a></p>
            <p><a href="/ocorrencias?key=5fdeb7c5&uf=CE&ano=2018&crime=Le&mes=jan" target="_blank" rel="noopener noreferrer">ocorrencias?key=5fdeb7c5&uf=CE&ano=2018&crime=Le&mes=jan</a></p>
            <br>
        </div>

        <h3>Base de Vítimas por município</h3>
        <div class="testes">
            <p><a href="/vitimas_municipios?key=397a32e6&cid=Marco" target="_blank" rel="noopener noreferrer">vitimas_municipios?key=397a32e6&cid=Marco</a></p>
            <p><a href="/vitimas_municipios?key=397a32e6&cid=Marco&ano=2020" target="_blank" rel="noopener noreferrer">vitimas_municipios?key=397a32e6&cid=Marco&ano=2020</a></p>
            <p><a href="/vitimas_municipios?key=397a32e6&cid=Marco&ano=2020&mes=jan" target="_blank" rel="noopener noreferrer">vitimas_municipios?key=397a32e6&cid=Marco&ano=2020&mes=jan</a></p>
            <p><a href="/vitimas_municipios?key=397a32e6&cid=Marco&ano=2020&mes=jan&uf=ce" target="_blank" rel="noopener noreferrer">vitimas_municipios?key=397a32e6&cid=Marco&ano=2020&mes=jan&uf=ce</a></p>
            <br>
        </div>

        <h3>Buscas pré-cadastradas com agrupamento</h3>
        <div class="testes">
            <p><a href="/info/media_ocorrencias_ano?key=397a32e6" target="_blank" rel="noopener noreferrer">media_ocorrencias_anual</a></p>
            <p><a href="/info/soma_municipios_estado?key=397a32e6" target="_blank" rel="noopener noreferrer">soma_municipios_estado</a></p>
            <p><a href="/info/soma_vitimas_crime?key=397a32e6" target="_blank" rel="noopener noreferrer">soma_vitimas_crime</a></p>
            <p><a href="/info/media_ocorrencias_crime_anual?key=397a32e6" target="_blank" rel="noopener noreferrer">media_ocorrencias_crime_anual</a></p>
            <p><a href="/info/media_ocorrencias_crime_estado_anual?key=397a32e6" target="_blank" rel="noopener noreferrer">media_ocorrencias_crime_estado_anual</a></p>
            <br>
        </div>

        <h3>Gráficos interativos</h3>
        <div class="testes">
            <p><a href="/plot/mapa_soma_ocorrencias?key=397a32e6" target="_blank" rel="noopener noreferrer">Mapa de soma das ocorrências por estado</a></p>
            <p><a href="/plot/linha_soma_ocorrencias?key=397a32e6" target="_blank" rel="noopener noreferrer">Gráfico de linhas da soma de ocorrências em cada estado</a></p>
            <p><a href="/plot/barras_media_ocorrencias?key=397a32e6" target="_blank" rel="noopener noreferrer">Gráfico de barras da média de ocorrências em cada estados</a></p>
            <br>
        </div>
    </body>
</html>